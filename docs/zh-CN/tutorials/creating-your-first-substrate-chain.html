<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Creating Your First Substrate chain · Substrate Developer Hub (@5517ab14)</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;p&gt;This document will walk you through the steps required to duplicate the demo that &lt;a href=&quot;https://youtu.be/0IoUZdDi5Is&quot;&gt;Gavin Wood presented at the 2018 Web3 Summit&lt;/a&gt;, showing off how you can build a Runtime Library for a Substrate Blockchain in less than 30 min.&lt;/p&gt;
"/><meta name="docsearch:version" content="1.0"/><meta name="docsearch:language" content="zh-CN"/><meta property="og:title" content="Creating Your First Substrate chain · Substrate Developer Hub (@5517ab14)"/><meta property="og:type" content="website"/><meta property="og:url" content="https://substrate-developer-hub.github.io//"/><meta property="og:description" content="&lt;p&gt;This document will walk you through the steps required to duplicate the demo that &lt;a href=&quot;https://youtu.be/0IoUZdDi5Is&quot;&gt;Gavin Wood presented at the 2018 Web3 Summit&lt;/a&gt;, showing off how you can build a Runtime Library for a Substrate Blockchain in less than 30 min.&lt;/p&gt;
"/><meta property="og:image" content="https://substrate-developer-hub.github.io/img/substrate-dev-hub-card.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://substrate-developer-hub.github.io/img/substrate-dev-hub-card.png"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="/js/clipboard.min.js"></script><script type="text/javascript" src="/js/code-block-buttons.js"></script><script type="text/javascript" src="/js/load.js"></script><script type="text/javascript" src="/js/config.js" defer=""></script><script type="text/javascript" src="/js/klaro.min.js" defer=""></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/prism.css"/><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/zh-CN"><img class="logo" src="/img/Substrate-logo.svg" alt="Substrate Developer Hub (@5517ab14)"/><h2 class="headerTitleWithLogo">Substrate Developer Hub (@5517ab14)</h2></a><a href="/zh-CN/versions"><h3>1.0</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/zh-CN/docs" target="_self">文档</a></li><li class=""><a href="/recipes/" target="_self">Recipes</a></li><li class=""><a href="/zh-CN/tutorials" target="_self">教程</a></li><li class=""><a href="/zh-CN/community" target="_self">社区</a></li><li class=""><a href="https://github.com/paritytech/substrate" target="_self">GitHub</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/img/language.svg" alt="Languages icon"/>中文</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/docs/en/tutorials/creating-your-first-substrate-chain">English</a></li><li><a href="/docs/ru/tutorials/creating-your-first-substrate-chain">Русский</a></li><li><a href="https://crowdin.com/project/substrate-developer-hub" target="_blank" rel="noreferrer noopener">参与翻译</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://crowdin.com/project/substrate-developer-hub/zh-CN" target="_blank" rel="noreferrer noopener">Translate</a><h1 class="postHeaderTitle">Creating Your First Substrate chain</h1></header><article><div><span><p>This document will walk you through the steps required to duplicate the demo that <a href="https://youtu.be/0IoUZdDi5Is">Gavin Wood presented at the 2018 Web3 Summit</a>, showing off how you can build a Runtime Library for a Substrate Blockchain in less than 30 min.</p>
<p>This tutorial will be written for a Mac OS X machine, and may require some finessing to get working on other operating systems.</p>
<h2><a class="anchor" aria-hidden="true" id="prerequisites"></a><a href="#prerequisites" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Prerequisites</h2>
<p>To start, make sure your machine has a recent <a href="https://www.npmjs.com/get-npm">node and npm</a> installed. Node version 11 is known to work. Then you're ready to <a href="/docs/zh-CN/getting-started/installing-substrate">install substrate</a> itself. It may take a little while, so grab some tea and <a href="http://tiny.cc/substrate-getting-started">optionally walk through this presentation</a>.</p>
<p>You will also need to set up a few more repositories into your working folder which were used in the demo:</p>
<ul>
<li><a href="https://github.com/paritytech/substrate/tree/master/node-template">Substrate Node Template</a></li>
<li><a href="https://github.com/paritytech/substrate-ui">Substrate UI</a></li>
</ul>
<p>You can do that with some <a href="https://github.com/paritytech/substrate-up">script aliases</a> that were loaded on your machine. You may need to restart your terminal in order for these scripts and other Substrate commands to become available to you.</p>
<pre><code class="hljs css language-bash">substrate-node-new substrate-node-template <span class="token operator">&lt;</span>author-name<span class="token operator">></span>
substrate-ui-new substrate
</code></pre>
<p>This will create a folder called <code>substrate-node-template</code> and <code>substrate-ui</code> with the corresponding repositories cloned in them. You can of course rename your projects in these commands, but for the sake of the clarity, we will continue with these folder names.</p>
<h2><a class="anchor" aria-hidden="true" id="launch-a-blockchain"></a><a href="#launch-a-blockchain" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Launch a Blockchain</h2>
<p>If you have set up everything correctly, you can now start a substrate dev chain! In the <code>substrate-node-template</code> folder, you can run the generated executable with:</p>
<pre><code class="hljs css language-bash">./target/release/substrate-node-template --dev
</code></pre>
<p>If you run into any errors starting or running your node, you may need to purge the chain files on your computer. You can do this by running: <code>./target/release/substrate-node-template purge-chain --dev</code>.</p>
<p>If everything is working it should start producing blocks!</p>
<p>To interact with the blockchain, you need to start the Substrate UI. Navigate to the <code>substrate-ui</code> folder and run:</p>
<pre><code class="hljs css language-bash"><span class="token function">yarn</span> <span class="token function">install</span>
<span class="token function">yarn</span> run dev
</code></pre>
<p>Finally, if open your browser to <code>http://localhost:8000</code>, you should be able to interact with your new chain!</p>
<h2><a class="anchor" aria-hidden="true" id="step-2-add-alice-to-your-network"></a><a href="#step-2-add-alice-to-your-network" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Step 2: Add Alice to your network</h2>
<p>Alice is a hard-coded account in your blockchain's <a href="https://github.com/paritytech/substrate/blob/master/node-template/src/chain_spec.rs#L43">genesis block configuration</a>. To make your life easier, this account is automatically pre-funded with currency and made a &quot;super user&quot; to your blockchain's upgrade system.</p>
<p>To access the &quot;Alice&quot; account, go to the <code>Wallet</code> section of the Substrate UI, and add Alice using her name and seed URI: <code>//Alice</code>.</p>
<p><img src="https://i.imgur.com/ItPlikV.png" alt="Adding Alice to your wallet"></p>
<p>If all is working correctly, you can now go into the <code>Send Funds</code> section and send funds from <code>Alice</code> to <code>Default</code>. You will see that Alice has a bunch of <code>units</code> pre-funded in her account, so send 5000 and wait for the green checkmark and an updated balance for <code>Default</code> to show that the transfer has been successfully recorded on the blockchain.</p>
<p><img src="https://i.imgur.com/8IIg292.png" alt="Sending funds from Alice to your default account"></p>
<h2><a class="anchor" aria-hidden="true" id="step-3-create-a-new-runtime-module"></a><a href="#step-3-create-a-new-runtime-module" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Step 3: Create a new runtime module</h2>
<p>Now it's time to create our own runtime.</p>
<p>Open up the <code>substrate-node-template</code> folder and create a new file:</p>
<pre><code class="hljs css language-bash">./runtime/src/demo.rs
</code></pre>
<p>This is where our new runtime module will live. Inline comments will hopefully give you insight to what the code is doing.</p>
<p>First, we will need to import a few libraries at the top of our file:</p>
<pre><code class="hljs css language-rust"><span class="token comment">// Encoding library</span>
<span class="token keyword">use</span> parity_codec<span class="token punctuation">:</span><span class="token punctuation">:</span>Encode<span class="token punctuation">;</span>

<span class="token comment">// Enables access to store a value in runtime storage</span>
<span class="token comment">// Imports the `Result` type that is returned from runtime functions</span>
<span class="token comment">// Imports the `decl_module!` and `decl_storage!` macros</span>
<span class="token keyword">use</span> support<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span>StorageValue<span class="token punctuation">,</span> dispatch<span class="token punctuation">:</span><span class="token punctuation">:</span>Result<span class="token punctuation">,</span> decl_module<span class="token punctuation">,</span> decl_storage<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Traits used for interacting with Substrate's Balances module</span>
<span class="token comment">// `Currency` gives you access to interact with the on-chain currency</span>
<span class="token comment">// `WithdrawReason` and `ExistenceRequirement` are enums for balance functions</span>
<span class="token keyword">use</span> support<span class="token punctuation">:</span><span class="token punctuation">:</span>traits<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span>Currency<span class="token punctuation">,</span> WithdrawReason<span class="token punctuation">,</span> ExistenceRequirement<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// These are traits which define behavior around math and hashing</span>
<span class="token keyword">use</span> runtime_primitives<span class="token punctuation">:</span><span class="token punctuation">:</span>traits<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span>Zero<span class="token punctuation">,</span> Hash<span class="token punctuation">,</span> Saturating<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Enables us to verify an call to our module is signed by a user account</span>
<span class="token keyword">use</span> system<span class="token punctuation">:</span><span class="token punctuation">:</span>ensure_signed<span class="token punctuation">;</span>
</code></pre>
<p>All modules need to declare a trait named <code>Trait</code> which is used to define the unique types needed by the module. In this case, our module does not have any unique types of it own, but does inherit types from the balances module such as a <code>Balance</code>, which is the currency of our system.</p>
<pre><code class="hljs css language-rust"><span class="token keyword">pub</span> <span class="token keyword">trait</span> Trait<span class="token punctuation">:</span> balances<span class="token punctuation">:</span><span class="token punctuation">:</span>Trait <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre>
<p>In this example, we will create a simple coin flip game. Users will pay an entry fee to play the game and then &quot;flip a coin&quot;. If they win they will get the contents of the pot. If they don't win, they will get nothing. No matter the outcome, their fee will be placed into the pot after the game resolves for the next user to try and win.</p>
<p>To start, we can define the storage items our module needs to track with the <a href="https://crates.parity.io/srml_support_procedural/macro.decl_storage.html"><code>decl_storage!</code> macro</a>:</p>
<pre><code class="hljs css language-rust"><span class="token macro-rules function">decl_storage!</span> <span class="token punctuation">{</span>
  <span class="token keyword">trait</span> Store <span class="token keyword">for</span> Module<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Trait<span class="token operator">></span> <span class="token keyword">as</span> Demo <span class="token punctuation">{</span>
    Payment <span class="token function">get</span><span class="token punctuation">(</span>payment<span class="token punctuation">)</span><span class="token punctuation">:</span> Option<span class="token operator">&lt;</span>T<span class="token punctuation">:</span><span class="token punctuation">:</span>Balance<span class="token operator">></span><span class="token punctuation">;</span>
    Pot <span class="token function">get</span><span class="token punctuation">(</span>pot<span class="token punctuation">)</span><span class="token punctuation">:</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>Balance<span class="token punctuation">;</span>
    Nonce <span class="token function">get</span><span class="token punctuation">(</span>nonce<span class="token punctuation">)</span><span class="token punctuation">:</span> u64<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>A macro is code in Rust which can be used to generate other code. Here we have introduced a macro and custom syntax to make the declaration of storage simple and easy to read. This macro will take care of generating all of the proper code needed to actually interact with the Substrate storage database.</p>
<p>You can see in our storage, we have three items, two of which track a <code>Balance</code>, and one that tracks a nonce which is represented as a <code>u64</code>. <code>Payment</code> uses an <code>Option</code> to wrap the balance so that we can represent whether or not the <code>Payment</code> has been initialized with a value. Easy enough :)</p>
<p>Next we will need to define our dispatchable functions: the ones that a user can use to call into our blockchain system. This game will have two functions the user can interact with: one that lets us set the initial payment, and one that lets us play the game.</p>
<pre><code class="hljs css language-rust"><span class="token macro-rules function">decl_module!</span> <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> <span class="token keyword">struct</span> Module<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Trait<span class="token operator">></span> <span class="token keyword">for</span> <span class="token keyword">enum</span> Call <span class="token keyword">where</span> origin<span class="token punctuation">:</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>Origin <span class="token punctuation">{</span>
        <span class="token keyword">fn</span> <span class="token function">set_payment</span><span class="token punctuation">(</span>_origin<span class="token punctuation">,</span> value<span class="token punctuation">:</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>Balance<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result <span class="token punctuation">{</span>
              <span class="token comment">// Logic for setting the game payment</span>
        <span class="token punctuation">}</span>

        <span class="token function">play</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result <span class="token punctuation">{</span>
              <span class="token comment">// Logic for playing the game</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Now that we have established our module structure, we can add the logic which powers these functions. First, we will write the logic for initializing our storage items:</p>
<pre><code class="hljs css language-rust"><span class="token comment">// This function initializes the `payment` storage item</span>
<span class="token comment">// It also populates the pot with an initial value</span>
<span class="token keyword">fn</span> <span class="token function">set_payment</span><span class="token punctuation">(</span>origin<span class="token punctuation">,</span> value<span class="token punctuation">:</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>Balance<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result <span class="token punctuation">{</span>
  <span class="token comment">// Ensure that the function call is a signed message (i.e. a transaction)</span>
  <span class="token keyword">let</span> _ <span class="token operator">=</span> <span class="token function">ensure_signed</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span>?<span class="token punctuation">;</span>

  <span class="token comment">// If `payment` is not initialized with some value</span>
  <span class="token keyword">if</span> <span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">payment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is_none</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Set the value of `payment`</span>
    <span class="token operator">&lt;</span>Payment<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">put</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Initialize the `pot` with the same value</span>
    <span class="token operator">&lt;</span>Pot<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">put</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Return Ok(()) when everything happens successfully</span>
  <span class="token function">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Then we will write the <code>play()</code> function which will actually allow users to play our game.</p>
<pre><code class="hljs css language-rust"><span class="token comment">// This function is allows a user to play our coin-flip game</span>
<span class="token keyword">fn</span> <span class="token function">play</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result <span class="token punctuation">{</span>
  <span class="token comment">// Ensure that the function call is a signed message (i.e. a transaction)</span>
  <span class="token comment">// Additionally, derive the sender address from the signed message</span>
  <span class="token keyword">let</span> sender <span class="token operator">=</span> <span class="token function">ensure_signed</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span>?<span class="token punctuation">;</span>

  <span class="token comment">// Ensure that `payment` storage item has been set</span>
  <span class="token keyword">let</span> payment <span class="token operator">=</span> <span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">payment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ok_or</span><span class="token punctuation">(</span><span class="token string">"Must have payment amount set"</span><span class="token punctuation">)</span>?<span class="token punctuation">;</span>

  <span class="token comment">// Read our storage values, and place them in memory variables</span>
  <span class="token keyword">let</span> <span class="token keyword">mut</span> nonce <span class="token operator">=</span> <span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">nonce</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> <span class="token keyword">mut</span> pot <span class="token operator">=</span> <span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">pot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Try to withdraw the payment from the account, making sure that it will not kill the account</span>
  <span class="token keyword">let</span> _ <span class="token operator">=</span> <span class="token operator">&lt;</span>balances<span class="token punctuation">:</span><span class="token punctuation">:</span>Module<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token keyword">as</span> Currency<span class="token operator">&lt;</span>_<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">withdraw</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>sender<span class="token punctuation">,</span> payment<span class="token punctuation">,</span> WithdrawReason<span class="token punctuation">:</span><span class="token punctuation">:</span>Reserve<span class="token punctuation">,</span> ExistenceRequirement<span class="token punctuation">:</span><span class="token punctuation">:</span>KeepAlive<span class="token punctuation">)</span>?<span class="token punctuation">;</span>

  <span class="token comment">// Generate a random hash between 0-255 using a csRNG algorithm</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>system<span class="token punctuation">:</span><span class="token punctuation">:</span>Module<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">random_seed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>sender<span class="token punctuation">,</span> nonce<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">using_encoded</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>T <span class="token keyword">as</span> system<span class="token punctuation">:</span><span class="token punctuation">:</span>Trait<span class="token operator">></span><span class="token punctuation">:</span><span class="token punctuation">:</span>Hashing<span class="token punctuation">:</span><span class="token punctuation">:</span>hash<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">using_encoded</span><span class="token punctuation">(</span><span class="token operator">|</span>e<span class="token operator">|</span> e<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">128</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token comment">// If the user won the coin flip, deposit the pot winnings; cannot fail</span>
      <span class="token keyword">let</span> _ <span class="token operator">=</span> <span class="token operator">&lt;</span>balances<span class="token punctuation">:</span><span class="token punctuation">:</span>Module<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token keyword">as</span> Currency<span class="token operator">&lt;</span>_<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">deposit_into_existing</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>sender<span class="token punctuation">,</span> pot<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">"`sender` must exist since a transaction is being made and withdraw will keep alive; qed."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// Reduce the pot to zero</span>
      pot <span class="token operator">=</span> Zero<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">zero</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// No matter the outcome, increase the pot by the payment amount</span>
  pot <span class="token operator">=</span> pot<span class="token punctuation">.</span><span class="token function">saturating_add</span><span class="token punctuation">(</span>payment<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Increment the nonce</span>
  nonce <span class="token operator">=</span> nonce<span class="token punctuation">.</span><span class="token function">wrapping_add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Store the updated values for our module</span>
  <span class="token operator">&lt;</span>Pot<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">put</span><span class="token punctuation">(</span>pot<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token operator">&lt;</span>Nonce<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">put</span><span class="token punctuation">(</span>nonce<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Return Ok(()) when everything happens successfully</span>
  <span class="token function">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<p>And that's it! This is how easy it can be to build new runtime modules using Substrate. You can also reference a <a href="https://github.com/substrate-developer-hub/substrate-package/blob/gav-demo/substrate-node-template/runtime/src/demo.rs">complete version</a> of this file to check your work.</p>
<h2><a class="anchor" aria-hidden="true" id="step-4-integrate-our-new-module-into-our-runtime"></a><a href="#step-4-integrate-our-new-module-into-our-runtime" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Step 4: Integrate our new module into our runtime</h2>
<p>To actually use our module, we need to tell our runtime that it exists. To do this we will be modifying the <code>./runtime/src/lib.rs</code> file:</p>
<p>First, we need to include the new file we created into our project:</p>
<pre><code class="hljs css language-rust"><span class="token punctuation">...</span>
<span class="token comment">/// Index of an account's extrinsic in the chain.</span>
<span class="token keyword">pub</span> <span class="token keyword">type</span> Nonce <span class="token operator">=</span> u64<span class="token punctuation">;</span>

<span class="token keyword">mod</span> demo<span class="token punctuation">;</span>     <span class="token comment">// Add this line</span>
</code></pre>
<p>Next, we need to tell our runtime about the <code>Trait</code> we exposed within the demo module.</p>
<pre><code class="hljs css language-rust"><span class="token punctuation">...</span>
<span class="token keyword">impl</span> sudo<span class="token punctuation">:</span><span class="token punctuation">:</span>Trait <span class="token keyword">for</span> Runtime <span class="token punctuation">{</span>
  <span class="token comment">/// The uniquitous event type.</span>
  <span class="token keyword">type</span> Event <span class="token operator">=</span> Event<span class="token punctuation">;</span>
  <span class="token keyword">type</span> Proposal <span class="token operator">=</span> Call<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> demo<span class="token punctuation">:</span><span class="token punctuation">:</span>Trait <span class="token keyword">for</span> Runtime <span class="token punctuation">{</span><span class="token punctuation">}</span>      <span class="token comment">// Add this line</span>
</code></pre>
<p>Finally, we need to include our demo module in the runtime constructor, which is handled by the <code>construct_runtime!</code> macro:</p>
<pre><code class="hljs css language-rust"><span class="token function">construct_runtime!</span><span class="token punctuation">(</span>
  <span class="token keyword">pub</span> <span class="token keyword">enum</span> Runtime with <span class="token function">Log</span><span class="token punctuation">(</span>InternalLog<span class="token punctuation">:</span> DigestItem<span class="token operator">&lt;</span>Hash<span class="token punctuation">,</span> Ed25519AuthorityId<span class="token operator">></span><span class="token punctuation">)</span> <span class="token keyword">where</span>
    Block <span class="token operator">=</span> Block<span class="token punctuation">,</span>
    NodeBlock <span class="token operator">=</span> opaque<span class="token punctuation">:</span><span class="token punctuation">:</span>Block<span class="token punctuation">,</span>
    UncheckedExtrinsic <span class="token operator">=</span> UncheckedExtrinsic
  <span class="token punctuation">{</span>
    System<span class="token punctuation">:</span> system<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span>default<span class="token punctuation">,</span> <span class="token function">Log</span><span class="token punctuation">(</span>ChangesTrieRoot<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    Timestamp<span class="token punctuation">:</span> timestamp<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span>Module<span class="token punctuation">,</span> Call<span class="token punctuation">,</span> Storage<span class="token punctuation">,</span> Config<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">,</span> Inherent<span class="token punctuation">}</span><span class="token punctuation">,</span>
    Consensus<span class="token punctuation">:</span> consensus<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span>Module<span class="token punctuation">,</span> Call<span class="token punctuation">,</span> Storage<span class="token punctuation">,</span> Config<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">,</span> <span class="token function">Log</span><span class="token punctuation">(</span>AuthoritiesChange<span class="token punctuation">)</span><span class="token punctuation">,</span> Inherent<span class="token punctuation">}</span><span class="token punctuation">,</span>
    Aura<span class="token punctuation">:</span> aura<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span>Module<span class="token punctuation">}</span><span class="token punctuation">,</span>
    Indices<span class="token punctuation">:</span> indices<span class="token punctuation">,</span>
    Balances<span class="token punctuation">:</span> balances<span class="token punctuation">,</span>
    Sudo<span class="token punctuation">:</span> sudo<span class="token punctuation">,</span>
    Demo<span class="token punctuation">:</span> demo<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span>Module<span class="token punctuation">,</span> Call<span class="token punctuation">,</span> Storage<span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token comment">// Add this line</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>To make it more clear when our upgrade is successful, we can also update the name of our runtime's specification and implementation:</p>
<pre><code class="hljs css language-rust"><span class="token comment">/// This runtime version.\npub const VERSION: RuntimeVersion = RuntimeVersion {</span>
  spec_name<span class="token punctuation">:</span> <span class="token function">create_runtime_str!</span><span class="token punctuation">(</span><span class="token string">"demo"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      <span class="token comment">// Update this name</span>
  impl_name<span class="token punctuation">:</span> <span class="token function">create_runtime_str!</span><span class="token punctuation">(</span><span class="token string">"demo-node"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// Update this name</span>
  authoring_version<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  spec_version<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  impl_version<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  apis<span class="token punctuation">:</span> RUNTIME_API_VERSIONS<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>Again, you can find a <a href="https://github.com/substrate-developer-hub/substrate-package/blob/gav-demo/substrate-node-template/runtime/src/lib.rs">complete version</a> of this file.</p>
<h2><a class="anchor" aria-hidden="true" id="step-5-upgrade-our-chain"></a><a href="#step-5-upgrade-our-chain" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Step 5: Upgrade our chain</h2>
<p>Now that we have created a new runtime module, it's time for us to upgrade our blockchain.</p>
<p>To do this, first we will need to compile our new runtime into a Wasm binary. Go into <code>substrate-node-template</code> and run:</p>
<pre><code class="hljs">./scripts/build.sh
</code></pre>
<p>If this completes successfully, it will update the file: <code>./runtime/wasm/target/wasm32-unknown-unknown/release/node_runtime.compact.wasm</code>. You can go back to the Substrate UI, and in the <code>Runtime Upgrade</code> section, you can select this file and press <code>upgrade</code>.</p>
<p><img src="https://i.imgur.com/c0O2Pnf.png" alt="Successful chain upgrade"></p>
<p>If all went well, you can see at the top of the Substrate UI that the <code>Runtime</code> will have our updated name!</p>
<p><img src="https://i.imgur.com/PLe219L.png" alt="An image of an updated runtime name"></p>
<h2><a class="anchor" aria-hidden="true" id="step-6-interacting-with-our-new-module"></a><a href="#step-6-interacting-with-our-new-module" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Step 6: Interacting with our new module</h2>
<p>Finally, we can try and play the game we created. We will begin our interaction through the browser console.</p>
<p>On the page with the Substrate UI, press <em>F12</em> to open your developer console. We will take advantage of some of the JavaScript libraries loaded on this page.</p>
<p>Before we can play the game, we need to initialize the <code>set_payment</code> from an account. We will call the function on behalf of Alice, who will generously initialize the pot with a signed message.</p>
<pre><code class="hljs css language-javascript"><span class="token function">post</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  sender<span class="token punctuation">:</span> runtime<span class="token punctuation">.</span>indices<span class="token punctuation">.</span><span class="token function">ss58Decode</span><span class="token punctuation">(</span><span class="token string">'F7Hs'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  call<span class="token punctuation">:</span> calls<span class="token punctuation">.</span>demo<span class="token punctuation">.</span><span class="token function">setPayment</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span>
</code></pre>
<p><img src="https://i.imgur.com/nl0h2Ei.png" alt="Setting the payment in the developer console"></p>
<p>When this call completed, you should see <code>{finalized: &quot;...&quot;}</code>, showing that it has been added to the chain. We can check this by reading the balance in the pot:</p>
<pre><code class="hljs css language-javascript">runtime<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>pot<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span>
</code></pre>
<p>Which should return <code>Number {1000}</code></p>
<h2><a class="anchor" aria-hidden="true" id="step-7-updating-our-substrate-ui"></a><a href="#step-7-updating-our-substrate-ui" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Step 7: Updating our Substrate UI</h2>
<p>Now that we see things are working in the background, it's time to give our UI some new legs. Let's add an interface so that someone can play our game. To do this we will need to modify the <code>substrate-ui</code> repository.</p>
<p>Open the <code>./src/app.jsx</code> file, and in the <code>readyRender()</code> function, you will see the code which generates all the different UX components.</p>
<p>For example, this code snippet controls the Runtime Upgrade UX that we most recently interacted with:</p>
<pre><code class="hljs css language-javascript"><span class="token keyword">class</span> <span class="token class-name">UpgradeSegment</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>conditionBond <span class="token operator">=</span> runtime<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">m</span> <span class="token operator">=></span>
      m<span class="token punctuation">.</span>modules <span class="token operator">&amp;&amp;</span> m<span class="token punctuation">.</span>modules<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token parameter">o</span> <span class="token operator">=></span> o<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">'sudo'</span><span class="token punctuation">)</span>
      <span class="token operator">||</span> m<span class="token punctuation">.</span>modules<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token parameter">o</span> <span class="token operator">=></span> o<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">'upgrade_key'</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>runtime <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bond</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>If condition<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>conditionBond<span class="token punctuation">}</span> then<span class="token operator">=</span><span class="token punctuation">{</span>
      <span class="token operator">&lt;</span>Segment style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> margin<span class="token punctuation">:</span> <span class="token string">'1em'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> padded<span class="token operator">></span>
        <span class="token operator">&lt;</span>Header <span class="token keyword">as</span><span class="token operator">=</span><span class="token string">'h2'</span><span class="token operator">></span>
          <span class="token operator">&lt;</span>Icon name<span class="token operator">=</span><span class="token string">'search'</span> <span class="token operator">/</span><span class="token operator">></span>
          <span class="token operator">&lt;</span>Header<span class="token punctuation">.</span>Content<span class="token operator">></span>
            Runtime Upgrade
            <span class="token operator">&lt;</span>Header<span class="token punctuation">.</span>Subheader<span class="token operator">></span>Upgrade the runtime using the UpgradeKey module<span class="token operator">&lt;</span><span class="token operator">/</span>Header<span class="token punctuation">.</span>Subheader<span class="token operator">></span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>Header<span class="token punctuation">.</span>Content<span class="token operator">></span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>Header<span class="token operator">></span>
        <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> paddingBottom<span class="token punctuation">:</span> <span class="token string">'1em'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
        <span class="token operator">&lt;</span>FileUploadBond bond<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>runtime<span class="token punctuation">}</span> content<span class="token operator">=</span><span class="token string">'Select Runtime'</span> <span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>TransactButton
          content<span class="token operator">=</span><span class="token string">"Upgrade"</span>
          icon<span class="token operator">=</span><span class="token string">'warning'</span>
          tx<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
            sender<span class="token punctuation">:</span> runtime<span class="token punctuation">.</span>sudo
              <span class="token operator">?</span> runtime<span class="token punctuation">.</span>sudo<span class="token punctuation">.</span>key
              <span class="token punctuation">:</span> runtime<span class="token punctuation">.</span>upgrade_key<span class="token punctuation">.</span>key<span class="token punctuation">,</span>
            call<span class="token punctuation">:</span> calls<span class="token punctuation">.</span>sudo
              <span class="token operator">?</span> calls<span class="token punctuation">.</span>sudo<span class="token punctuation">.</span><span class="token function">sudo</span><span class="token punctuation">(</span>calls<span class="token punctuation">.</span>consensus<span class="token punctuation">.</span><span class="token function">setCode</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>runtime<span class="token punctuation">)</span><span class="token punctuation">)</span>
              <span class="token punctuation">:</span> calls<span class="token punctuation">.</span>upgrade_key<span class="token punctuation">.</span><span class="token function">upgrade</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>runtime<span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>Segment<span class="token operator">></span>
    <span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>We can use this as a template for how we should add our game's UI. At the end of the file, add the following code:</p>
<pre><code class="hljs css language-javascript"><span class="token keyword">class</span> <span class="token class-name">DemoSegment</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>player <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bond</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>Segment style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> margin<span class="token punctuation">:</span> <span class="token string">'1em'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> padded<span class="token operator">></span>
      <span class="token operator">&lt;</span>Header <span class="token keyword">as</span><span class="token operator">=</span><span class="token string">'h2'</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>Icon name<span class="token operator">=</span><span class="token string">'game'</span> <span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>Header<span class="token punctuation">.</span>Content<span class="token operator">></span>
          Play the game
          <span class="token operator">&lt;</span>Header<span class="token punctuation">.</span>Subheader<span class="token operator">></span>Play the game here<span class="token operator">!</span><span class="token operator">&lt;</span><span class="token operator">/</span>Header<span class="token punctuation">.</span>Subheader<span class="token operator">></span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>Header<span class="token punctuation">.</span>Content<span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>Header<span class="token operator">></span>
      <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> paddingBottom<span class="token punctuation">:</span> <span class="token string">'1em'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> fontSize<span class="token punctuation">:</span> <span class="token string">'small'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span>player<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
        <span class="token operator">&lt;</span>SignerBond bond<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>player<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>If condition<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>player<span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span> then<span class="token operator">=</span><span class="token punctuation">{</span><span class="token operator">&lt;</span>span<span class="token operator">></span>
          <span class="token operator">&lt;</span>Label<span class="token operator">></span>Balance
            <span class="token operator">&lt;</span>Label<span class="token punctuation">.</span>Detail<span class="token operator">></span>
              <span class="token operator">&lt;</span>Pretty value<span class="token operator">=</span><span class="token punctuation">{</span>runtime<span class="token punctuation">.</span>balances<span class="token punctuation">.</span><span class="token function">balance</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>player<span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>Label<span class="token punctuation">.</span>Detail<span class="token operator">></span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>Label<span class="token operator">></span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
      <span class="token operator">&lt;</span>TransactButton
        content<span class="token operator">=</span><span class="token string">"Play"</span>
        icon<span class="token operator">=</span><span class="token string">'game'</span>
        tx<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
          sender<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>player<span class="token punctuation">,</span>
          call<span class="token punctuation">:</span> calls<span class="token punctuation">.</span>demo<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>Label<span class="token operator">></span>Pot Balance
        <span class="token operator">&lt;</span>Label<span class="token punctuation">.</span>Detail<span class="token operator">></span>
          <span class="token operator">&lt;</span>Pretty value<span class="token operator">=</span><span class="token punctuation">{</span>runtime<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>pot<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>Label<span class="token punctuation">.</span>Detail<span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>Label<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Segment<span class="token operator">></span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Beyond the updated text, you can see we are accessing a new <code>this.player</code> bond, which represents the user context playing the game.</p>
<p>Using this, we can get details like the user's balance:</p>
<pre><code class="hljs css language-javascript">runtime<span class="token punctuation">.</span>balances<span class="token punctuation">.</span><span class="token function">balance</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>player<span class="token punctuation">)</span>
</code></pre>
<p>And submit transactions on behalf of this user:</p>
<pre><code class="hljs css language-javascript">tx<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
  sender<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>player<span class="token punctuation">,</span>
  call<span class="token punctuation">:</span> calls<span class="token punctuation">.</span>demo<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre>
<p>Also notice that we are able to dynamically show content like the current balance of the pot in a similar way to how we retrieved it in the developer console:</p>
<pre><code class="hljs css language-javascript"><span class="token operator">&lt;</span>Label<span class="token operator">></span>Pot Balance
  <span class="token operator">&lt;</span>Label<span class="token punctuation">.</span>Detail<span class="token operator">></span>
    <span class="token operator">&lt;</span>Pretty value<span class="token operator">=</span><span class="token punctuation">{</span>runtime<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>pot<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>Label<span class="token punctuation">.</span>Detail<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>Label<span class="token operator">></span>
</code></pre>
<p>The only thing left for us to do, is to add this component into our <code>App</code> class at the top of the file:</p>
<pre><code class="hljs css language-javascript"><span class="token function">readyRender</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>div<span class="token operator">></span>
    <span class="token operator">&lt;</span>Heading <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>WalletSegment <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>Divider hidden <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>AddressBookSegment <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>Divider hidden <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>FundingSegment <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>Divider hidden <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>UpgradeSegment <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>Divider hidden <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>PokeSegment <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>Divider hidden <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>TransactionsSegment <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>Divider hidden <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>DemoSegment <span class="token operator">/</span><span class="token operator">></span>      <span class="token comment">// Add this line</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<p>If you save your changes and reload the page, you should see your new UI! You can now try playing the game with the <code>Default</code> user:</p>
<p><img src="https://i.imgur.com/sIspIKE.png" alt="Player losing the game"></p>
<p>Here you can see the player lost the game, which means that their 1000 units got added to the pot, and an additional 1 unit transaction fee was taken from their balance.</p>
<p>If we try a few more times, eventually the player will win the game, and the pot will be reset back to its starting amount for the next player:</p>
<p><img src="https://i.imgur.com/kqQIF3p.png" alt="Player winning the game"></p>
<h2><a class="anchor" aria-hidden="true" id="final-notes"></a><a href="#final-notes" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Final Notes</h2>
<p>That's all folks! While you can't actually make a profit playing this game, hopefully you see just how simple Substrate can make it to develop your next blockchain.</p>
<p>In summary, we showed you how to:</p>
<ul>
<li>Download and install <code>substrate</code> to your machine in a single command</li>
<li>Set up a fresh <code>substrate-node-template</code> and <code>substrate-ui</code> so that you can start hacking right away</li>
<li>Program a new runtime for your blockchain</li>
<li>Upgrade your runtime, in real-time and without forking, via the <code>substrate-ui</code></li>
<li>Update the <code>substrate-ui</code> to reflect your new runtime features and functionality</li>
</ul>
<p>Substrate is a rapidly developing technology, and we would love to get your feedback, answer questions, and learn more about what you want to build!</p>
</span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#prerequisites">Prerequisites</a></li><li><a href="#launch-a-blockchain">Launch a Blockchain</a></li><li><a href="#step-2-add-alice-to-your-network">Step 2: Add Alice to your network</a></li><li><a href="#step-3-create-a-new-runtime-module">Step 3: Create a new runtime module</a></li><li><a href="#step-4-integrate-our-new-module-into-our-runtime">Step 4: Integrate our new module into our runtime</a></li><li><a href="#step-5-upgrade-our-chain">Step 5: Upgrade our chain</a></li><li><a href="#step-6-interacting-with-our-new-module">Step 6: Interacting with our new module</a></li><li><a href="#step-7-updating-our-substrate-ui">Step 7: Updating our Substrate UI</a></li><li><a href="#final-notes">Final Notes</a></li></ul></nav></div><footer class="nav-footer" id="footer"><div><style>
#blast {
  position: fixed;
  width: 100%;
  bottom: 0;
  height: 50px;
  background-image: url(/img/bg-sub01.svg); background-size: cover; background-position: right 0px bottom 500px;;
  color: #18FFB2;
  z-index: 99999;
  text-align: center;
  background-color: #000028;
  transition: background-color 0.2s;
}
#blast:hover {
  background-color: #E91E63;
}

#blast h2 {
  margin: 0;
  line-height: 50px;
}

#blast a {
  display: block;
  color: #18FFB2;
  text-decoration: underline;
  mix-blend-mode: lighten;
}

#blast img {
  max-height: 50px;
}

body {
  margin-bottom: 50px;
}
</style><section id="blast"><a href="https://sub0.parity.io" target="_blank"><img src="/img/sub0-blast.png" class="img-fluid"/></a></section></div><section class="sitemap"><a href="/" class="nav-home"><img src="/img/Substrate-logo.svg" alt="Substrate Developer Hub (@5517ab14)" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/zh-CN/getting-started">Getting Started</a><a href="/zh-CN/tutorials">Tutorials</a><a href="/rustdocs/v1.0/">Reference Docs</a><a href="/recipes/">Recipes</a></div><div><h5>Community</h5><a href="/zh-CN/videos">Videos</a><a href="/zh-CN/seminar">Substrate Seminar</a><a href="http://stackoverflow.com/questions/tagged/substrate" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://riot.im/app/#/room/!HzySYSaIhtyWrwiwEV:matrix.org">Riot Chat</a><a href="https://twitter.com/ParityTech" target="_blank" rel="noreferrer noopener">Twitter</a><a href="https://www.meetup.com/parity/" target="_blank" rel="noreferrer noopener">Events</a></div><div><h5>More</h5><a href="https://www.parity.io/blog/">Blog</a><a href="https://github.com/paritytech/substrate">Substrate GitHub</a><a href="https://github.com/substrate-developer-hub/">Developer Hub GitHub</a><a href="https://www.parity.io/privacy/">Privacy Policy</a><a href="#" id="cookie-settings">Cookie Settings<script>
              var cookieSettings = document.getElementById('cookie-settings');
              cookieSettings.onclick = function() {
                return klaro.show();
              };
              </script></a></div></section><section class="copyright">Copyright © 2019 Parity Technologies</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '5cd09916f4ba4c283b2d45ee7386fc34',
                indexName: 'substrate',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["language:zh-CN"]}
              });
            </script></body></html>