<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Part 2 - Display balances · Substrate Developer Hub (@5517ab14)</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;p&gt;Now that we have the connection to our node, let&#x27;s play with some accounts. Because we are connected to a node launched with the &lt;code&gt;--dev&lt;/code&gt; flag, we can get access to accounts that are pre-funded and whose private keys are known to us. Accounts are organized in a so-called keyring. From this keyring, you can get the address of an account, its associated name, and its cryptographic keypair if this account is managed locally. The &lt;a href=&quot;https://polkadot.js.org/ui/ui-keyring/&quot;&gt;&lt;code&gt;@polkadot/ui-keyring&lt;/code&gt;&lt;/a&gt; package contains many utilities to manage accounts. We will make use of them in the following sections.&lt;/p&gt;
"/><meta name="docsearch:version" content="next"/><meta name="docsearch:language" content="zh-CN"/><meta property="og:title" content="Part 2 - Display balances · Substrate Developer Hub (@5517ab14)"/><meta property="og:type" content="website"/><meta property="og:url" content="https://substrate-developer-hub.github.io//"/><meta property="og:description" content="&lt;p&gt;Now that we have the connection to our node, let&#x27;s play with some accounts. Because we are connected to a node launched with the &lt;code&gt;--dev&lt;/code&gt; flag, we can get access to accounts that are pre-funded and whose private keys are known to us. Accounts are organized in a so-called keyring. From this keyring, you can get the address of an account, its associated name, and its cryptographic keypair if this account is managed locally. The &lt;a href=&quot;https://polkadot.js.org/ui/ui-keyring/&quot;&gt;&lt;code&gt;@polkadot/ui-keyring&lt;/code&gt;&lt;/a&gt; package contains many utilities to manage accounts. We will make use of them in the following sections.&lt;/p&gt;
"/><meta property="og:image" content="https://substrate-developer-hub.github.io/img/substrate-dev-hub-card.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://substrate-developer-hub.github.io/img/substrate-dev-hub-card.png"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="/js/clipboard.min.js"></script><script type="text/javascript" src="/js/code-block-buttons.js"></script><script type="text/javascript" src="/js/load.js"></script><script type="text/javascript" src="/js/config.js" defer=""></script><script type="text/javascript" src="/js/klaro.min.js" defer=""></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/prism.css"/><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/zh-CN"><img class="logo" src="/img/Substrate-logo.svg" alt="Substrate Developer Hub (@5517ab14)"/><h2 class="headerTitleWithLogo">Substrate Developer Hub (@5517ab14)</h2></a><a href="/zh-CN/versions"><h3>next</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/zh-CN/docs" target="_self">文档</a></li><li class=""><a href="/recipes/" target="_self">Recipes</a></li><li class=""><a href="/zh-CN/tutorials" target="_self">教程</a></li><li class=""><a href="/zh-CN/community" target="_self">社区</a></li><li class=""><a href="https://github.com/paritytech/substrate" target="_self">GitHub</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/img/language.svg" alt="Languages icon"/>中文</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/docs/en/next/tutorials/substrate-front-end/part-2-query-balances">English</a></li><li><a href="/docs/ru/next/tutorials/substrate-front-end/part-2-query-balances">Русский</a></li><li><a href="https://crowdin.com/project/substrate-developer-hub" target="_blank" rel="noreferrer noopener">参与翻译</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://crowdin.com/project/substrate-developer-hub/zh-CN" target="_blank" rel="noreferrer noopener">Translate</a><h1 class="postHeaderTitle">Part 2 - Display balances</h1></header><article><div><span><p>Now that we have the connection to our node, let's play with some accounts. Because we are connected to a node launched with the <code>--dev</code> flag, we can get access to accounts that are pre-funded and whose private keys are known to us. Accounts are organized in a so-called keyring. From this keyring, you can get the address of an account, its associated name, and its cryptographic keypair if this account is managed locally. The <a href="https://polkadot.js.org/ui/ui-keyring/"><code>@polkadot/ui-keyring</code></a> package contains many utilities to manage accounts. We will make use of them in the following sections.</p>
<p>In this part we will use the <a href="https://polkadot.js.org/api/METHODS_STORAGE.html"><code>api.query</code></a> method to access the storage of the <code>balances</code> blockchain component.</p>
<h2><a class="anchor" aria-hidden="true" id="21-get-testing-accounts"></a><a href="#21-get-testing-accounts" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2.1 Get testing accounts</h2>
<p>First things first, let's import the <code>keyring</code> object; We needed to add <code>@polkadot/keyring</code>, <code>@polkadot/ui-identicon</code>, <code>@polkadot/ui-keyring</code> as dependencies to our project to get access to the keyring utilities.</p>
<pre><code class="hljs css language-js"><span class="token keyword">import</span> keyring <span class="token keyword">from</span> <span class="token string">'@polkadot/ui-keyring'</span><span class="token punctuation">;</span>
</code></pre>
<p>Initializing this keyring is simple, all we need to do is call <code>loadAll()</code>. To get access to the testing accounts, we can simply pass the object <code>{isDevelopment: true}</code> as a parameter. We will add a new <code>useEffect</code> function to initialize our keyring. Let's <code>console.log</code> it to inspect what it gives us.</p>
<p>This is the code we added:</p>
<pre><code class="hljs css language-js">  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span> 
    keyring<span class="token punctuation">.</span><span class="token function">loadAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      isDevelopment<span class="token punctuation">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>keyring<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre>
<p>And this is what you should get in the console:</p>
<pre><code class="hljs">{…}
​_accounts: Object { add: add(), remove: remove(), subject: {…} }
​_addresses: Object { add: add(), remove: remove(), subject: {…} }
​_contracts: Object { add: add(), remove: remove(), subject: {…} }
​_genesisHash: undefined
​_keyring: Object { _pairs: {…}, _type: &quot;ed25519&quot;, decodeAddress: decode(), … }
​_prefix: undefined
​_store: Object {  }
​decodeAddress: function decodeAddress()​
encodeAddress: function encodeAddress()​
stores: Object { address: address(), contract: contract(), account: account() }
</code></pre>
<p>If you expand the <code>_keyring</code> and <code>_pairs</code> objects, you'll see that we have some key pairs here. Those are the testing accounts that were initialized thanks to the <code>isDevelopment</code> flag. We will now build a Balances component so that we can display those accounts. This Balances component will very soon show all our accounts with the amount of funds in each one.</p>
<p>Let's start by listing the account names and their addresses. Nothing fancy here other than what we talked about before, <code>getPairs()</code> will give us the array of the accounts in our keyring. Mapping through this array lets us display the name and address of each of our accounts.</p>
<pre><code class="hljs css language-js"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Table <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'semantic-ui-react'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Balances</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> keyring <span class="token punctuation">}</span> <span class="token operator">=</span> props<span class="token punctuation">;</span>
  <span class="token keyword">const</span> accounts <span class="token operator">=</span> keyring<span class="token punctuation">.</span><span class="token function">getPairs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Balances<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Table</span></span> <span class="token attr-name">celled</span> <span class="token attr-name">striped</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Table.Body</span></span><span class="token punctuation">></span></span>
          <span class="token punctuation">{</span>accounts<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">account<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Table.Row</span></span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>index<span class="token punctuation">}</span></span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Table.Cell</span></span> <span class="token attr-name">textAlign</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>right<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>account<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Table.Cell</span></span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Table.Cell</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>account<span class="token punctuation">.</span>address<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Table.Cell</span></span><span class="token punctuation">></span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Table.Row</span></span><span class="token punctuation">></span></span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Table.Body</span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Table</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Of course we need to amend the entry point of our DApp, <code>Apps.js</code>, to import this new component and render it. Note that we also passed the <code>api</code> as a prop, this is not needed at this exact moment in the tutorial, but we will make use of it right after.</p>
<pre><code class="hljs css language-js"><span class="token comment">// at the top of the file</span>
<span class="token keyword">import</span> Balances <span class="token keyword">from</span> <span class="token string">'./Balances'</span><span class="token punctuation">;</span>

<span class="token comment">// in the return, after NodeInfo</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Balances</span></span>
  <span class="token attr-name">api</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>api<span class="token punctuation">}</span></span>
  <span class="token attr-name">keyring</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>keyring<span class="token punctuation">}</span></span>
<span class="token punctuation">/></span></span>
</code></pre>
<p>You can get the working version of this code by visiting <code>part-2-1</code> directory:</p>
<pre><code class="hljs css language-bash"><span class="token function">cd</span> part-2-1<span class="token punctuation">;</span>
<span class="token function">yarn</span><span class="token punctuation">;</span>
<span class="token function">yarn</span> start<span class="token punctuation">;</span>
</code></pre>
<p>If you run this example, you will get a table with &quot;Alice&quot;, &quot;Alice_stash&quot;, &quot;Bob&quot;, and their addresses.</p>
<p><img src="/docs/assets/tutorials/substrate-front-end/part-2-1.jpg" alt="Testing accounts name and address"></p>
<h2><a class="anchor" aria-hidden="true" id="22-query-and-display-alice-s-balance"></a><a href="#22-query-and-display-alice-s-balance" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2.2 Query and display Alice's balance</h2>
<p>Now that we have our accounts, we can query the balance for each one of them. The Substrate node that you are connected to has a <code>Balances</code> module that keeps track of the balance of every account on the blockchain. We will watch the <code>freeBalance</code> of an account. The <a href="https://polkadot.js.org/api/api/">Polkadot-js API</a> allows you to query the storage of a module with <code>api.query</code> and to subscribe to updates of these values. This is how we can get access to this <code>freeBalance</code> information.</p>
<p>Let's start small and query the balance for one account, Alice.</p>
<pre><code class="hljs css language-js"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Balances</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> api<span class="token punctuation">,</span> keyring <span class="token punctuation">}</span> <span class="token operator">=</span> props<span class="token punctuation">;</span>
  <span class="token keyword">const</span> accounts <span class="token operator">=</span> keyring<span class="token punctuation">.</span><span class="token function">getPairs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// this state will keep track of Alice's freeBalance</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>balance<span class="token punctuation">,</span> setBalance<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> unsubscribe<span class="token punctuation">;</span>

    api<span class="token punctuation">.</span>query<span class="token punctuation">.</span>balances<span class="token punctuation">.</span><span class="token function">freeBalance</span><span class="token punctuation">(</span>accounts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>address<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">currentBalance</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token function">setBalance</span><span class="token punctuation">(</span>currentBalance<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">unsub</span> <span class="token operator">=></span> <span class="token punctuation">{</span> unsubscribe <span class="token operator">=</span> unsub<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> unsubscribe <span class="token operator">&amp;&amp;</span> <span class="token function">unsubscribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>accounts<span class="token punctuation">,</span> api<span class="token punctuation">.</span>query<span class="token punctuation">.</span>balances<span class="token punctuation">,</span> api<span class="token punctuation">.</span>query<span class="token punctuation">.</span>balances<span class="token punctuation">.</span>freeBalance<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>We start by creating a state variable called <code>balance</code>, which we will initialize at <code>0</code>. Then, as we did in the previous part, we will make the query in a React hook with <code>useEffect</code>. We want to display the balance and subscribe to all changes populated by the Substrate node.</p>
<p><strong>Subscribe</strong></p>
<p>The API method <code>api.query.balances.freeBalance()</code> takes an account address as its first argument and you can pass an optional callback as the second argument to subscribe to any update. The callback function then listens to changes of the <code>freeBalance</code> value of the given account.</p>
<p>We're updating the component's state with the values we're getting from the API and that's what allows us to see the balance change without reloading the page!</p>
<p><strong>Unsubscribe</strong></p>
<p>But because it's a subscription, we must unsubscribe whenever our <code>Balances</code> React component unmounts. The <code>unsubscribe</code> function is what is actually returned by the <code>query</code>. This one must be called in the <code>return</code> statement of the <code>useEffect</code> that will be called whenever the component unmounts. In our case, it's when we close the tab or refresh our applications manually.</p>
<p>Let's strip down the table we return to show only the balance for Alice.</p>
<pre><code class="hljs css language-js">  <span class="token comment">// the end of the Balance.js file</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Balances<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Table</span></span> <span class="token attr-name">celled</span> <span class="token attr-name">striped</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Table.Body</span></span><span class="token punctuation">></span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Table.Row</span></span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Table.Cell</span></span> <span class="token attr-name">textAlign</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>right<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>accounts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Table.Cell</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Table.Cell</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>accounts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>address<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Table.Cell</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Table.Cell</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>balance<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Table.Cell</span></span><span class="token punctuation">></span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Table.Row</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Table.Body</span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Table</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>You can get the working version of this code by visiting the <code>part-2-2</code> directory:</p>
<pre><code class="hljs css language-bash"><span class="token function">cd</span> part-2-2<span class="token punctuation">;</span>
<span class="token function">yarn</span><span class="token punctuation">;</span>
<span class="token function">yarn</span> start<span class="token punctuation">;</span>
</code></pre>
<p>If you run this example, you will get a table with Alice's account and balance.</p>
<p><img src="/docs/assets/tutorials/substrate-front-end/part-2-2.jpg" alt="Alice balance"></p>
<h2><a class="anchor" aria-hidden="true" id="23-query-and-display-all-balances"></a><a href="#23-query-and-display-all-balances" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2.3 Query and display all balances</h2>
<p>Now that we know how querying the state of a module works, we can map through all of our accounts and query the state for each one. The <code>api</code> has a handy function to batch multiple queries at the same time; it's called <code>multi</code>. You can pass an array of arguments and it will return the results as an array.</p>
<p>Instead of having just the balance of Alice in the state, we will change it to an object mapping <code>address</code> with <code>freeBalance</code> so that we can use it to display each account's balance. Because the <code>multi</code> remains one subscription, the logic for unsubscribing remains the same.</p>
<pre><code class="hljs css language-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> api<span class="token punctuation">,</span> keyring <span class="token punctuation">}</span> <span class="token operator">=</span> props<span class="token punctuation">;</span>
<span class="token keyword">const</span> accounts <span class="token operator">=</span> keyring<span class="token punctuation">.</span><span class="token function">getPairs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> addresses <span class="token operator">=</span> accounts<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">account</span> <span class="token operator">=></span> account<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> accountNames <span class="token operator">=</span> accounts<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">account</span><span class="token punctuation">)</span> <span class="token operator">=></span> account<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>balances<span class="token punctuation">,</span> setBalances<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> unsubscribeAll

  api<span class="token punctuation">.</span>query<span class="token punctuation">.</span>balances<span class="token punctuation">.</span>freeBalance
    <span class="token punctuation">.</span><span class="token function">multi</span><span class="token punctuation">(</span>addresses<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">currentBalances</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> balancesMap <span class="token operator">=</span> addresses<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">acc<span class="token punctuation">,</span> address<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token operator">...</span>acc<span class="token punctuation">,</span>
        <span class="token punctuation">[</span>address<span class="token punctuation">]</span><span class="token punctuation">:</span> currentBalances<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">setBalances</span><span class="token punctuation">(</span>balancesMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">unsub</span> <span class="token operator">=></span> <span class="token punctuation">{</span> unsubscribeAll <span class="token operator">=</span> unsub<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> unsubscribeAll <span class="token operator">&amp;&amp;</span> <span class="token function">unsubscribeAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>addresses<span class="token punctuation">,</span> api<span class="token punctuation">.</span>query<span class="token punctuation">.</span>balances<span class="token punctuation">.</span>freeBalance<span class="token punctuation">,</span> setBalances<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>We call <code>api.query.balances.freeBalance.multi</code> and pass our array of addresses, the callback then receives an array of results. From there we create an object with <code>reduce</code> that contains the address and balance of each account. This object is what we will persist in the state.</p>
<p>Displaying the accounts with their balances is now easy. We will map through our list of addresses and display the names and balances.</p>
<pre><code class="hljs css language-js">  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Balances<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Table</span></span> <span class="token attr-name">celled</span> <span class="token attr-name">striped</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Table.Body</span></span><span class="token punctuation">></span></span>
          <span class="token punctuation">{</span>addresses<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">address<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Table.Row</span></span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>index<span class="token punctuation">}</span></span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Table.Cell</span></span> <span class="token attr-name">textAlign</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>right<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>accountNames<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Table.Cell</span></span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Table.Cell</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>address<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Table.Cell</span></span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Table.Cell</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>balances <span class="token operator">&amp;&amp;</span> balances<span class="token punctuation">[</span>address<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Table.Cell</span></span><span class="token punctuation">></span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Table.Row</span></span><span class="token punctuation">></span></span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Table.Body</span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Table</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>You can get the working version of this code by visiting the <code>part-2-3</code> directory:</p>
<pre><code class="hljs css language-bash"><span class="token function">cd</span> part-2-3<span class="token punctuation">;</span>
<span class="token function">yarn</span><span class="token punctuation">;</span>
<span class="token function">yarn</span> start<span class="token punctuation">;</span>
</code></pre>
<p>If you run this example, you will get a table with all our testing accounts, their addresses, and their balances.</p>
<p><img src="/docs/assets/tutorials/substrate-front-end/part-2-3.jpg" alt="All balances"></p>
<h2><a class="anchor" aria-hidden="true" id="24-good-to-know"></a><a href="#24-good-to-know" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2.4 Good to know</h2>
<p>It is worth mentioning that the funds in <code>freeBalancee</code> of an account might <strong>not</strong> be available to transfer. An account could very well have funds, but if for example those are staked (a.k.a bonded) for validating, you might not be able to transfer them even though <code>freeBalance</code> is not null. If you want to show the balance available to transfer, this is computed in a so-called <code>api-derive</code>. Have a look at the <code>available</code> field returned by <a href="https://github.com/polkadot-js/api/blob/master/packages/api-derive/src/balances/all.ts"><code>derive.balances.all</code></a>.</p>
<p>The <code>derive api</code>, as its name suggests, is not a direct query to the node. It is rather a concatenation and derivation of multiple queries to serve information that is not directly accessible by the node. A popular one is <a href="https://github.com/polkadot-js/api/blob/master/packages/api-derive/src/chain/bestNumber.ts"><code>derive.chain.bestNumber</code></a> to get the latest block number. Have a look at <a href="https://github.com/polkadot-js/api/blob/master/packages/api-derive/src/">the repo</a>. Unfortunately, those <code>api</code> endpoints are only documented in the code for now.</p>
<p>Substrate is a framework to build blockchains. The <code>--dev</code> node that we are querying in this part contains a Balances module from the <a href="https://substrate.dev/rustdocs/v1.0/srml_balances/index.html"><strong>S</strong>ubstrate <strong>R</strong>untime <strong>M</strong>odule <strong>L</strong>ibrary a.k.a SRML</a>, which keeps track of the balance of each account on the blockchain. Not every Substrate chain will have this Balances module. However, any module that is integrated into a Substrate node can be queried using <code>api.query.section.method</code>.</p>
</span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#21-get-testing-accounts">2.1 Get testing accounts</a></li><li><a href="#22-query-and-display-alice-s-balance">2.2 Query and display Alice's balance</a></li><li><a href="#23-query-and-display-all-balances">2.3 Query and display all balances</a></li><li><a href="#24-good-to-know">2.4 Good to know</a></li></ul></nav></div><footer class="nav-footer" id="footer"><div><style>
#blast {
  position: fixed;
  width: 100%;
  bottom: 0;
  height: 50px;
  background-image: url(/img/bg-sub01.svg); background-size: cover; background-position: right 0px bottom 500px;;
  color: #18FFB2;
  z-index: 99999;
  text-align: center;
  background-color: #000028;
  transition: background-color 0.2s;
}
#blast:hover {
  background-color: #E91E63;
}

#blast h2 {
  margin: 0;
  line-height: 50px;
}

#blast a {
  display: block;
  color: #18FFB2;
  text-decoration: underline;
  mix-blend-mode: lighten;
}

#blast img {
  max-height: 50px;
}

body {
  margin-bottom: 50px;
}
</style><section id="blast"><a href="https://sub0.parity.io" target="_blank"><img src="/img/sub0-blast.png" class="img-fluid"/></a></section></div><section class="sitemap"><a href="/" class="nav-home"><img src="/img/Substrate-logo.svg" alt="Substrate Developer Hub (@5517ab14)" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/zh-CN/getting-started">Getting Started</a><a href="/zh-CN/tutorials">Tutorials</a><a href="/rustdocs/v1.0/">Reference Docs</a><a href="/recipes/">Recipes</a></div><div><h5>Community</h5><a href="/zh-CN/videos">Videos</a><a href="/zh-CN/seminar">Substrate Seminar</a><a href="http://stackoverflow.com/questions/tagged/substrate" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://riot.im/app/#/room/!HzySYSaIhtyWrwiwEV:matrix.org">Riot Chat</a><a href="https://twitter.com/ParityTech" target="_blank" rel="noreferrer noopener">Twitter</a><a href="https://www.meetup.com/parity/" target="_blank" rel="noreferrer noopener">Events</a></div><div><h5>More</h5><a href="https://www.parity.io/blog/">Blog</a><a href="https://github.com/paritytech/substrate">Substrate GitHub</a><a href="https://github.com/substrate-developer-hub/">Developer Hub GitHub</a><a href="https://www.parity.io/privacy/">Privacy Policy</a><a href="#" id="cookie-settings">Cookie Settings<script>
              var cookieSettings = document.getElementById('cookie-settings');
              cookieSettings.onclick = function() {
                return klaro.show();
              };
              </script></a></div></section><section class="copyright">Copyright © 2019 Parity Technologies</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '5cd09916f4ba4c283b2d45ee7386fc34',
                indexName: 'substrate',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["language:zh-CN"]}
              });
            </script></body></html>